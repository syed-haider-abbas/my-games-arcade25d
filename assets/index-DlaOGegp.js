import{P as r,c as $,p,u as A,r as O,j as e,B as w,f as S,V as L}from"./index-BcjuW5Zz.js";var b=(l=>(l.IDLE="IDLE",l.PLAYING="PLAYING",l.WON="WON",l))(b||{});const P=15,t=40,k=14,R=[{x:6,y:13},{x:6,y:12},{x:6,y:11},{x:6,y:10},{x:6,y:9},{x:5,y:8},{x:4,y:8},{x:3,y:8},{x:2,y:8},{x:1,y:8},{x:0,y:8},{x:0,y:7},{x:0,y:6},{x:1,y:6},{x:2,y:6},{x:3,y:6},{x:4,y:6},{x:5,y:6},{x:6,y:5},{x:6,y:4},{x:6,y:3},{x:6,y:2},{x:6,y:1},{x:6,y:0},{x:7,y:0},{x:8,y:0},{x:8,y:1},{x:8,y:2},{x:8,y:3},{x:8,y:4},{x:8,y:5},{x:9,y:6},{x:10,y:6},{x:11,y:6},{x:12,y:6},{x:13,y:6},{x:14,y:6},{x:14,y:7},{x:14,y:8},{x:13,y:8},{x:12,y:8},{x:11,y:8},{x:10,y:8},{x:9,y:8},{x:8,y:9},{x:8,y:10},{x:8,y:11},{x:8,y:12},{x:8,y:13},{x:8,y:14},{x:7,y:14},{x:6,y:14}],v={[r.ONE]:[{x:7,y:13},{x:7,y:12},{x:7,y:11},{x:7,y:10},{x:7,y:9},{x:7,y:8}],[r.TWO]:[{x:7,y:1},{x:7,y:2},{x:7,y:3},{x:7,y:4},{x:7,y:5},{x:7,y:6}]},I={[r.ONE]:0,[r.TWO]:26},W={[r.ONE]:[{x:2,y:11},{x:3,y:11},{x:2,y:12},{x:3,y:12}],[r.TWO]:[{x:11,y:2},{x:12,y:2},{x:11,y:3},{x:12,y:3}]},u={BOARD_BG:16777215,GRID_STROKE:14870768,P1_MAIN:3900150,P1_LIGHT:14412542,P2_MAIN:15381256,P2_LIGHT:16710083,SAFE_STAR:13358561},E=R.length,D=(l,n,d)=>{if(n===-1)return W[l][d];if(n===99){const a=(d-.5)*.4;return{x:7+a,y:7+a}}if(n>=52){const x=n-52;return v[l]&&v[l][x]?v[l][x]:{x:7,y:7}}const o=I[l],i=(n+o)%E;return R[i]||{x:0,y:0}},G=(l,n)=>l.position===-1?n===6:!(l.position+n>57),M=(l,n,d)=>{const o=l.map(a=>({...a})),i=o.find(a=>a.id===n);let x=!1,s=!1;if(i.position===-1?i.position=0:i.position+=d,i.position===57)return i.position=99,s=!0,{newTokens:o,captured:x,finished:s};if(i.position<52){const a=I[i.playerId],h=(i.position+a)%E;for(const c of o)if(c.playerId!==i.playerId&&c.position!==-1&&c.position!==99&&c.position<52){const m=I[c.playerId],N=(c.position+m)%E;h===N&&([0,8,13,21,26,34,39,47].includes(N)||(c.position=-1,x=!0))}}return{newTokens:o,captured:x,finished:s}},H=[{id:"p1-0",playerId:r.ONE,position:-1},{id:"p1-1",playerId:r.ONE,position:-1},{id:"p2-0",playerId:r.TWO,position:-1},{id:"p2-1",playerId:r.TWO,position:-1}],T=()=>({status:b.IDLE,turn:r.ONE,diceValue:null,tokens:JSON.parse(JSON.stringify(H)),winner:null,isRolling:!1,canRoll:!0,highlightedTokens:[]}),_=$((l,n)=>({...T(),startGame:()=>{p("start"),l({...T(),status:b.PLAYING})},resetGame:()=>{p("click"),l(T())},rollDice:()=>{const{isRolling:d,canRoll:o,turn:i,tokens:x}=n();!o||d||(l({isRolling:!0}),p("roll"),setTimeout(()=>{const s=Math.floor(Math.random()*6)+1,h=x.filter(c=>c.playerId===i&&c.position!==99).filter(c=>G(c,s)).map(c=>c.id);l({isRolling:!1,diceValue:s,highlightedTokens:h,canRoll:!1}),h.length===0&&setTimeout(()=>{const c=i===r.ONE?r.TWO:r.ONE;l({turn:c,diceValue:null,canRoll:!0,highlightedTokens:[]})},1e3)},1e3))},moveToken:d=>{const{highlightedTokens:o,tokens:i,diceValue:x,turn:s}=n();if(!o.includes(d)||!x)return;const{newTokens:a,captured:h,finished:c}=M(i,d,x);if(p("tap"),h&&setTimeout(()=>p("drop"),300),c&&p("win"),a.filter(f=>f.playerId===s).every(f=>f.position===99))l({tokens:a,status:b.WON,winner:s,highlightedTokens:[]}),p("win");else{let f=s;x!==6&&(f=s===r.ONE?r.TWO:r.ONE),l({tokens:a,turn:f,diceValue:null,canRoll:!0,highlightedTokens:[]})}}})),y=l=>"#"+l.toString(16).padStart(6,"0"),B=()=>{const{tokens:l,highlightedTokens:n,moveToken:d}=_(),{enableTilt:o}=A(),i=P*t,x=O.useMemo(()=>{const s=[];return s.push(e.jsx("rect",{x:0,y:0,width:i,height:i,fill:y(u.BOARD_BG)},"bg")),s.push(e.jsxs("g",{children:[e.jsx("rect",{x:0,y:0,width:6*t,height:6*t,fill:"#fecaca",rx:12}),e.jsx("rect",{x:0,y:9*t,width:6*t,height:6*t,fill:y(u.P1_LIGHT),rx:12})]},"base-p1")),s.push(e.jsxs("g",{children:[e.jsx("rect",{x:9*t,y:9*t,width:6*t,height:6*t,fill:"#a7f3d0",rx:12}),e.jsx("rect",{x:9*t,y:0,width:6*t,height:6*t,fill:y(u.P2_LIGHT),rx:12})]},"base-p2")),R.forEach((a,h)=>{const c=[0,8,13,21,26,34,39,47].includes(h);s.push(e.jsx("rect",{x:a.x*t,y:a.y*t,width:t,height:t,fill:c?y(u.SAFE_STAR):"#ffffff",stroke:y(u.GRID_STROKE),strokeWidth:1},`main-${h}`))}),v[r.ONE].forEach((a,h)=>{s.push(e.jsx("rect",{x:a.x*t,y:a.y*t,width:t,height:t,fill:y(u.P1_LIGHT),stroke:y(u.GRID_STROKE),strokeWidth:1},`home-p1-${h}`))}),v[r.TWO].forEach((a,h)=>{s.push(e.jsx("rect",{x:a.x*t,y:a.y*t,width:t,height:t,fill:y(u.P2_LIGHT),stroke:y(u.GRID_STROKE),strokeWidth:1},`home-p2-${h}`))}),s.push(e.jsx("rect",{x:6*t,y:6*t,width:3*t,height:3*t,fill:"#f1f5f9"},"center-bg")),s.push(e.jsx("polygon",{points:`${6*t},${9*t} ${9*t},${9*t} ${7.5*t},${7.5*t}`,fill:y(u.P1_MAIN),fillOpacity:.2},"center-p1")),s.push(e.jsx("polygon",{points:`${6*t},${6*t} ${9*t},${6*t} ${7.5*t},${7.5*t}`,fill:y(u.P2_MAIN),fillOpacity:.2},"center-p2")),s},[i]);return e.jsx("div",{className:"w-full max-w-2xl aspect-square flex justify-center items-center",children:e.jsx("div",{className:"transition-transform duration-500 will-change-transform shadow-2xl rounded-xl overflow-hidden bg-white",style:{width:"100%",height:"100%",transform:o?"rotateX(20deg) scale(0.9)":"none"},children:e.jsxs("svg",{viewBox:`0 0 ${i} ${i}`,className:"w-full h-full",style:{shapeRendering:"geometricPrecision"},children:[x,l.map(s=>{const a=parseInt(s.id.split("-")[1]),{x:h,y:c}=D(s.playerId,s.position,a),m=n.includes(s.id),N=s.playerId===r.ONE?y(u.P1_MAIN):y(u.P2_MAIN),f=h*t+t/2,g=c*t+t/2;return e.jsxs("g",{onClick:()=>m&&d(s.id),style:{cursor:m?"pointer":"default"},children:[m&&e.jsx("circle",{cx:f,cy:g,r:k+8,fill:"white",fillOpacity:.5,className:"animate-pulse"}),e.jsx("circle",{cx:f,cy:g,r:k,fill:N,stroke:"white",strokeWidth:2}),e.jsx("circle",{cx:f-4,cy:g-4,r:k/3,fill:"white",fillOpacity:.3}),s.position===99&&e.jsx("path",{d:`M${f-3} ${g} L${f} ${g+3} L${f+4} ${g-3}`,fill:"none",stroke:"white",strokeWidth:2})]},s.id)})]})})})},C=()=>e.jsx("div",{className:"w-2.5 h-2.5 bg-slate-800 rounded-full shadow-inner"}),j=({dots:l,transform:n})=>{const d={1:"top-2 left-2",2:"top-2 right-2",3:"top-1/2 left-2 -translate-y-1/2",4:"top-1/2 right-2 -translate-y-1/2",5:"bottom-2 left-2",6:"bottom-2 right-2",7:"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},o=i=>{switch(i){case 1:return[7];case 2:return[1,6];case 3:return[1,7,6];case 4:return[1,2,5,6];case 5:return[1,2,5,6,7];case 6:return[1,2,3,4,5,6];default:return[]}};return e.jsx("div",{className:"absolute w-full h-full bg-white border-2 border-slate-200 rounded-xl flex shadow-[inset_0_0_20px_rgba(0,0,0,0.1)] backface-hidden",style:{transform:n},children:o(l[0]).map(i=>e.jsx("div",{className:`absolute ${d[i]}`,children:e.jsx(C,{})},i))})},z=()=>{const{diceValue:l,isRolling:n,rollDice:d,canRoll:o}=_(),[i,x]=O.useState({x:0,y:0});return O.useEffect(()=>{if(l){const s={1:{x:0,y:0},6:{x:180,y:0},2:{x:0,y:-90},5:{x:0,y:90},3:{x:90,y:0},4:{x:-90,y:0}}[l]||{x:0,y:0};x(n?{x:s.x+720,y:s.y+720}:s)}else n&&x({x:1080,y:1080})},[l,n]),e.jsxs("div",{className:"relative w-20 h-20 perspective-1000 cursor-pointer group",onClick:d,children:[e.jsxs("div",{className:`w-full h-full relative preserve-3d transition-transform duration-[1000ms] ease-out ${o?"group-hover:scale-110":"opacity-80"}`,style:{transform:`rotateX(${i.x}deg) rotateY(${i.y}deg)`},children:[e.jsx(j,{dots:[1],transform:"translateZ(40px)"}),e.jsx(j,{dots:[6],transform:"rotateY(180deg) translateZ(40px)"}),e.jsx(j,{dots:[2],transform:"rotateY(90deg) translateZ(40px)"}),e.jsx(j,{dots:[5],transform:"rotateY(-90deg) translateZ(40px)"}),e.jsx(j,{dots:[3],transform:"rotateX(90deg) translateZ(40px)"}),e.jsx(j,{dots:[4],transform:"rotateX(-90deg) translateZ(40px)"})]}),o&&!n&&e.jsx("div",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 text-xs font-bold text-white uppercase tracking-wider animate-pulse whitespace-nowrap bg-black/50 px-2 py-1 rounded-full",children:"Tap to Roll"})]})},V=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),Z=()=>{const{status:l,startGame:n,resetGame:d,turn:o,winner:i}=_(),{setView:x}=A(),s=()=>{d(),x(L.HOME)};return l===b.IDLE?e.jsxs("div",{className:"flex flex-col h-screen w-full bg-slate-50 dark:bg-[#0f172a] overflow-hidden relative",children:[e.jsx("header",{className:"shrink-0 h-16 md:h-20 px-4 flex items-center justify-center bg-white/50 dark:bg-slate-900/50 backdrop-blur-md z-10",children:e.jsx(w,{variant:"icon",size:"sm",onClick:s,title:"Home",children:e.jsx(V,{})})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 space-y-8 animate-fade-in relative z-0",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-blue-400/20 rounded-full blur-[100px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-yellow-400/20 rounded-full blur-[100px]"}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"inline-block text-8xl mb-2 animate-bounce font-emoji",children:S("üé≤")}),e.jsx("h1",{className:"text-5xl md:text-6xl font-black text-slate-900 dark:text-white tracking-tight",children:"Little Ludo"}),e.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400 font-medium max-w-md mx-auto",children:"A fun race to the finish! Roll the dice and move your tokens home."})]}),e.jsx(w,{onClick:n,size:"lg",className:"!text-2xl !py-6 !px-12 shadow-xl shadow-blue-500/30 !bg-blue-500 hover:!bg-blue-400",children:"Start Game"})]})]}):e.jsxs("div",{className:"flex flex-col h-screen w-full bg-slate-100 dark:bg-slate-900 overflow-hidden relative",children:[e.jsxs("header",{className:"shrink-0 h-16 md:h-20 px-4 flex items-center justify-between bg-white/50 dark:bg-slate-900/50 backdrop-blur-md z-20 border-b border-white/10 relative",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${o===r.ONE?"bg-blue-500 animate-pulse":"bg-slate-300"}`}),e.jsx("span",{className:`font-bold ${o===r.ONE?"text-blue-600":"text-slate-400"}`,children:"Player 1"})]}),e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:e.jsx("div",{className:"text-lg font-black text-slate-500 tracking-wider",children:"LUDO"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-bold ${o===r.TWO?"text-yellow-600":"text-slate-400"}`,children:"Player 2"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${o===r.TWO?"bg-yellow-500 animate-pulse":"bg-slate-300"}`})]})]}),e.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center relative p-4 perspective-1000",children:[e.jsx("div",{className:"relative z-0",children:e.jsx(B,{})}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-20 pointer-events-auto",children:e.jsx(z,{})})]}),e.jsx("div",{className:"shrink-0 h-16 flex items-center justify-center",children:e.jsx(w,{variant:"secondary",size:"sm",onClick:s,children:"Exit Game"})}),l===b.WON&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-3xl shadow-2xl max-w-sm w-full text-center border-4 border-blue-400 animate-bounce-in",children:[e.jsx("div",{className:"text-6xl mb-4 font-emoji",children:S("üèÜ")}),e.jsx("h2",{className:"text-3xl font-black text-slate-900 dark:text-white mb-2",children:i===r.ONE?"Blue Wins!":"Yellow Wins!"}),e.jsxs("div",{className:"flex flex-col gap-3 mt-6",children:[e.jsx(w,{onClick:n,size:"lg",className:"w-full",children:"Play Again"}),e.jsx(w,{onClick:s,variant:"secondary",className:"w-full",children:"Back to Menu"})]})]})})]})};export{Z as LittleLudoGame};
