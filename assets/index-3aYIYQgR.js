import{P as c,c as P,p as g,u as _,r as T,j as e,f as E,B as w,V as M}from"./index-Cj8O8_35.js";var v=(l=>(l.IDLE="IDLE",l.PLAYING="PLAYING",l.WON="WON",l))(v||{});const W=15,t=40,O=14,S=[{x:6,y:13},{x:6,y:12},{x:6,y:11},{x:6,y:10},{x:6,y:9},{x:5,y:8},{x:4,y:8},{x:3,y:8},{x:2,y:8},{x:1,y:8},{x:0,y:8},{x:0,y:7},{x:0,y:6},{x:1,y:6},{x:2,y:6},{x:3,y:6},{x:4,y:6},{x:5,y:6},{x:6,y:5},{x:6,y:4},{x:6,y:3},{x:6,y:2},{x:6,y:1},{x:6,y:0},{x:7,y:0},{x:8,y:0},{x:8,y:1},{x:8,y:2},{x:8,y:3},{x:8,y:4},{x:8,y:5},{x:9,y:6},{x:10,y:6},{x:11,y:6},{x:12,y:6},{x:13,y:6},{x:14,y:6},{x:14,y:7},{x:14,y:8},{x:13,y:8},{x:12,y:8},{x:11,y:8},{x:10,y:8},{x:9,y:8},{x:8,y:9},{x:8,y:10},{x:8,y:11},{x:8,y:12},{x:8,y:13},{x:8,y:14},{x:7,y:14},{x:6,y:14}],N={[c.ONE]:[{x:7,y:13},{x:7,y:12},{x:7,y:11},{x:7,y:10},{x:7,y:9},{x:7,y:8}],[c.TWO]:[{x:7,y:1},{x:7,y:2},{x:7,y:3},{x:7,y:4},{x:7,y:5},{x:7,y:6}]},R={[c.ONE]:0,[c.TWO]:26},G={[c.ONE]:[{x:2,y:11},{x:3,y:11},{x:2,y:12},{x:3,y:12}],[c.TWO]:[{x:11,y:2},{x:12,y:2},{x:11,y:3},{x:12,y:3}]},f={BOARD_BG:16777215,GRID_STROKE:14870768,P1_MAIN:3900150,P1_LIGHT:14412542,P2_MAIN:15381256,P2_LIGHT:16710083,SAFE_STAR:13358561},L=S.length,D=(l,i,x)=>{if(i===-1)return G[l][x];if(i===99){const r=(x-.5)*.4;return{x:7+r,y:7+r}}if(i>=52){const o=i-52;return N[l]&&N[l][o]?N[l][o]:{x:7,y:7}}const d=R[l],n=(i+d)%L;return S[n]||{x:0,y:0}},C=(l,i)=>l.position===-1?i===6:!(l.position+i>57),B=(l,i,x)=>{const d=l.map(r=>({...r})),n=d.find(r=>r.id===i);let o=!1,s=!1;if(n.position===-1?n.position=0:n.position+=x,n.position===57)return n.position=99,s=!0,{newTokens:d,captured:o,finished:s};if(n.position<52){const r=R[n.playerId],h=(n.position+r)%L;for(const a of d)if(a.playerId!==n.playerId&&a.position!==-1&&a.position!==99&&a.position<52){const y=R[a.playerId],p=(a.position+y)%L;h===p&&([0,8,13,21,26,34,39,47].includes(p)||(a.position=-1,o=!0))}}return{newTokens:d,captured:o,finished:s}},H=[{id:"p1-0",playerId:c.ONE,position:-1},{id:"p1-1",playerId:c.ONE,position:-1},{id:"p2-0",playerId:c.TWO,position:-1},{id:"p2-1",playerId:c.TWO,position:-1}],I=()=>({status:v.IDLE,turn:c.ONE,diceValue:null,tokens:JSON.parse(JSON.stringify(H)),winner:null,isRolling:!1,canRoll:!0,highlightedTokens:[]}),k=P((l,i)=>({...I(),startGame:()=>{g("start"),l({...I(),status:v.PLAYING})},resetGame:()=>{g("click"),l(I())},rollDice:()=>{const{isRolling:x,canRoll:d,turn:n,tokens:o}=i();!d||x||(l({isRolling:!0}),g("roll"),setTimeout(()=>{const s=Math.floor(Math.random()*6)+1,h=o.filter(a=>a.playerId===n&&a.position!==99).filter(a=>C(a,s)).map(a=>a.id);l({isRolling:!1,diceValue:s,highlightedTokens:h,canRoll:!1}),h.length===0&&setTimeout(()=>{const a=n===c.ONE?c.TWO:c.ONE;l({turn:a,diceValue:null,canRoll:!0,highlightedTokens:[]})},1e3)},1e3))},moveToken:x=>{const{highlightedTokens:d,tokens:n,diceValue:o,turn:s}=i();if(!d.includes(x)||!o)return;const{newTokens:r,captured:h,finished:a}=B(n,x,o);if(g("tap"),h&&setTimeout(()=>g("drop"),300),a&&g("win"),r.filter(u=>u.playerId===s).every(u=>u.position===99))l({tokens:r,status:v.WON,winner:s,highlightedTokens:[]}),g("win");else{let u=s;o!==6&&(u=s===c.ONE?c.TWO:c.ONE),l({tokens:r,turn:u,diceValue:null,canRoll:!0,highlightedTokens:[]})}}})),m=l=>"#"+l.toString(16).padStart(6,"0"),z=()=>{const{tokens:l,highlightedTokens:i,moveToken:x}=k(),{enableTilt:d}=_(),n=W*t,o=T.useMemo(()=>{const s=[];return s.push(e.jsx("rect",{x:0,y:0,width:n,height:n,fill:m(f.BOARD_BG)},"bg")),s.push(e.jsxs("g",{children:[e.jsx("rect",{x:0,y:0,width:6*t,height:6*t,fill:"#fecaca",rx:12}),e.jsx("rect",{x:0,y:9*t,width:6*t,height:6*t,fill:m(f.P1_LIGHT),rx:12})]},"base-p1")),s.push(e.jsxs("g",{children:[e.jsx("rect",{x:9*t,y:9*t,width:6*t,height:6*t,fill:"#a7f3d0",rx:12}),e.jsx("rect",{x:9*t,y:0,width:6*t,height:6*t,fill:m(f.P2_LIGHT),rx:12})]},"base-p2")),S.forEach((r,h)=>{const a=[0,8,13,21,26,34,39,47].includes(h);s.push(e.jsx("rect",{x:r.x*t,y:r.y*t,width:t,height:t,fill:a?m(f.SAFE_STAR):"#ffffff",stroke:m(f.GRID_STROKE),strokeWidth:1},`main-${h}`))}),N[c.ONE].forEach((r,h)=>{s.push(e.jsx("rect",{x:r.x*t,y:r.y*t,width:t,height:t,fill:m(f.P1_LIGHT),stroke:m(f.GRID_STROKE),strokeWidth:1},`home-p1-${h}`))}),N[c.TWO].forEach((r,h)=>{s.push(e.jsx("rect",{x:r.x*t,y:r.y*t,width:t,height:t,fill:m(f.P2_LIGHT),stroke:m(f.GRID_STROKE),strokeWidth:1},`home-p2-${h}`))}),s.push(e.jsx("rect",{x:6*t,y:6*t,width:3*t,height:3*t,fill:"#f1f5f9"},"center-bg")),s.push(e.jsx("polygon",{points:`${6*t},${9*t} ${9*t},${9*t} ${7.5*t},${7.5*t}`,fill:m(f.P1_MAIN),fillOpacity:.2},"center-p1")),s.push(e.jsx("polygon",{points:`${6*t},${6*t} ${9*t},${6*t} ${7.5*t},${7.5*t}`,fill:m(f.P2_MAIN),fillOpacity:.2},"center-p2")),s},[n]);return e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsx("div",{className:"transition-transform duration-500 will-change-transform shadow-2xl rounded-xl overflow-hidden bg-white",style:{width:"100%",height:"100%",transform:d?"rotateX(20deg) scale(0.9)":"none"},children:e.jsxs("svg",{viewBox:`0 0 ${n} ${n}`,className:"w-full h-full",style:{shapeRendering:"geometricPrecision"},children:[o,l.map(s=>{const r=parseInt(s.id.split("-")[1]),{x:h,y:a}=D(s.playerId,s.position,r),y=i.includes(s.id),p=s.playerId===c.ONE?m(f.P1_MAIN):m(f.P2_MAIN),u=h*t+t/2,j=a*t+t/2;return e.jsxs("g",{onClick:()=>y&&x(s.id),style:{cursor:y?"pointer":"default"},children:[y&&e.jsx("circle",{cx:u,cy:j,r:O+8,fill:"white",fillOpacity:.5,className:"animate-pulse"}),e.jsx("circle",{cx:u,cy:j,r:O,fill:p,stroke:"white",strokeWidth:2}),e.jsx("circle",{cx:u-4,cy:j-4,r:O/3,fill:"white",fillOpacity:.3}),s.position===99&&e.jsx("path",{d:`M${u-3} ${j} L${u} ${j+3} L${u+4} ${j-3}`,fill:"none",stroke:"white",strokeWidth:2})]},s.id)})]})})})},V=()=>e.jsx("div",{className:"w-2.5 h-2.5 bg-slate-800 rounded-full shadow-inner"}),b=({dots:l,transform:i})=>{const x={1:"top-2 left-2",2:"top-2 right-2",3:"top-1/2 left-2 -translate-y-1/2",4:"top-1/2 right-2 -translate-y-1/2",5:"bottom-2 left-2",6:"bottom-2 right-2",7:"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},d=n=>{switch(n){case 1:return[7];case 2:return[1,6];case 3:return[1,7,6];case 4:return[1,2,5,6];case 5:return[1,2,5,6,7];case 6:return[1,2,3,4,5,6];default:return[]}};return e.jsx("div",{className:"absolute w-full h-full bg-white border-2 border-slate-200 rounded-xl flex shadow-[inset_0_0_20px_rgba(0,0,0,0.1)] backface-hidden",style:{transform:i},children:d(l[0]).map(n=>e.jsx("div",{className:`absolute ${x[n]}`,children:e.jsx(V,{})},n))})},Y=()=>{const{diceValue:l,isRolling:i,rollDice:x,canRoll:d}=k(),[n,o]=T.useState({x:0,y:0});return T.useEffect(()=>{if(l){const s={1:{x:0,y:0},6:{x:180,y:0},2:{x:0,y:-90},5:{x:0,y:90},3:{x:90,y:0},4:{x:-90,y:0}}[l]||{x:0,y:0};o(i?{x:s.x+720,y:s.y+720}:s)}else i&&o({x:1080,y:1080})},[l,i]),e.jsxs("div",{className:"relative w-20 h-20 perspective-1000 cursor-pointer group",onClick:x,children:[e.jsxs("div",{className:`w-full h-full relative preserve-3d transition-transform duration-[1000ms] ease-out ${d?"group-hover:scale-110":"opacity-80"}`,style:{transform:`rotateX(${n.x}deg) rotateY(${n.y}deg)`},children:[e.jsx(b,{dots:[1],transform:"translateZ(40px)"}),e.jsx(b,{dots:[6],transform:"rotateY(180deg) translateZ(40px)"}),e.jsx(b,{dots:[2],transform:"rotateY(90deg) translateZ(40px)"}),e.jsx(b,{dots:[5],transform:"rotateY(-90deg) translateZ(40px)"}),e.jsx(b,{dots:[3],transform:"rotateX(90deg) translateZ(40px)"}),e.jsx(b,{dots:[4],transform:"rotateX(-90deg) translateZ(40px)"})]}),d&&!i&&e.jsx("div",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 text-xs font-bold text-white uppercase tracking-wider animate-pulse whitespace-nowrap bg-black/50 px-2 py-1 rounded-full",children:"Tap to Roll"})]})},$=T.memo(({playerId:l,alignment:i})=>{const x=k(u=>u.turn),d=k(u=>u.winner),n=_(u=>u.players[l]),o=x===l,s=d===l,r=i==="right",h=l===c.ONE,a=h?"text-blue-600 dark:text-blue-400":"text-yellow-600 dark:text-yellow-400",y=h?"bg-blue-500":"bg-yellow-500",p=h?"from-blue-400 to-blue-600":"from-yellow-300 to-yellow-500";return e.jsxs("div",{className:`
        flex items-center gap-3 md:gap-4
        transition-all duration-300
        ${r?"flex-row-reverse text-right":"flex-row text-left"}
        ${o?"opacity-100 scale-105":"opacity-60 grayscale-[0.5] scale-100"}
      `,children:[e.jsxs("div",{className:`
          relative
          w-10 h-10 md:w-14 md:h-14 rounded-xl md:rounded-2xl
          flex items-center justify-center
          bg-gradient-to-br ${p}
          shadow-lg
          border-2 ${o?"border-white":"border-transparent"}
          transition-all duration-300
        `,children:[e.jsx("span",{className:"text-lg md:text-2xl font-black text-white select-none",children:n.name[0]}),s&&e.jsx("div",{className:"absolute -top-3 -right-3 text-2xl animate-bounce font-emoji",children:E("üëë")})]}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("h2",{className:`text-sm md:text-lg font-bold ${a} leading-tight transition-colors`,children:n.name}),e.jsx("div",{className:"flex items-center gap-2 mt-0.5",children:o&&!d&&e.jsx("div",{className:`
                 px-2 py-0.5 rounded-full 
                 ${y} text-white 
                 text-[10px] font-bold uppercase tracking-wider animate-pulse
               `,children:"Turn"})})]})]})}),A=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-4 h-4 md:w-5 md:h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),Z=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-4 h-4 md:w-5 md:h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),K=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-4 h-4 md:w-5 md:h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})}),F=()=>{const{status:l,startGame:i,resetGame:x,turn:d,winner:n}=k(),{setView:o}=_(),s=()=>{x(),o(M.HOME)},r=()=>{i()},h=()=>{x()};return l===v.IDLE?e.jsxs("div",{className:"flex flex-col h-screen w-full bg-slate-50 dark:bg-[#0f172a] overflow-hidden relative transition-colors duration-500",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none opacity-40",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-blue-400/20 dark:bg-blue-900/20 rounded-full blur-[100px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-yellow-400/20 dark:bg-yellow-900/20 rounded-full blur-[100px]"})]}),e.jsx("header",{className:"shrink-0 h-16 md:h-20 px-4 flex items-center justify-center bg-white/50 dark:bg-slate-900/50 backdrop-blur-md z-30 sticky top-0 border-b border-slate-200/50 dark:border-white/5",children:e.jsx(w,{variant:"icon",size:"sm",onClick:s,title:"Return to Menu",children:e.jsx(A,{})})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 space-y-8 animate-fade-in relative z-20",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"inline-block text-8xl mb-2 animate-bounce font-emoji",children:E("üé≤")}),e.jsx("h1",{className:"text-5xl md:text-6xl font-black text-slate-900 dark:text-white tracking-tight",children:"Little Ludo"}),e.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400 font-medium max-w-md mx-auto",children:"A fun race to the finish! Roll the dice and move your tokens home."})]}),e.jsx(w,{onClick:i,size:"lg",className:"!text-2xl !py-6 !px-12 shadow-xl shadow-blue-500/30 !bg-blue-500 hover:!bg-blue-400",children:"Start Game"})]})]}):e.jsxs("div",{className:"flex flex-col h-screen w-full bg-slate-100 dark:bg-slate-900 overflow-hidden relative transition-colors duration-500",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none opacity-40",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-blue-400/20 dark:bg-blue-900/20 rounded-full blur-[100px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-yellow-400/20 dark:bg-yellow-900/20 rounded-full blur-[100px]"})]}),e.jsxs("header",{className:"shrink-0 h-16 md:h-20 px-3 md:px-8 flex items-center justify-between z-30 bg-white/60 dark:bg-black/20 backdrop-blur-md border-b border-slate-200 dark:border-white/5 relative shadow-sm transition-colors duration-300",children:[e.jsx("div",{className:"flex-1 flex justify-start min-w-0",children:e.jsx($,{playerId:c.ONE,alignment:"left"})}),e.jsxs("div",{className:"shrink-0 flex gap-2 mx-2",children:[e.jsx(w,{variant:"icon",size:"sm",onClick:h,title:"Back to Game Menu",className:"w-9 h-9 md:w-11 md:h-11 p-2",children:e.jsx(Z,{})}),e.jsx(w,{variant:"icon",size:"sm",onClick:r,title:"Restart Game",className:"w-9 h-9 md:w-11 md:h-11 p-2",children:e.jsx(K,{})}),e.jsx(w,{variant:"icon",size:"sm",onClick:s,title:"Return to Menu",className:"w-9 h-9 md:w-11 md:h-11 p-2",children:e.jsx(A,{})})]}),e.jsx("div",{className:"flex-1 flex justify-end min-w-0",children:e.jsx($,{playerId:c.TWO,alignment:"right"})})]}),e.jsx("main",{className:"flex-1 w-full h-full flex flex-col items-center justify-center p-2 pb-10 relative z-10 perspective-1000 overflow-hidden",children:e.jsx("div",{className:`
                    relative aspect-square 
                    portrait:w-full portrait:max-h-full
                    landscape:h-full landscape:max-w-full
                    flex items-center justify-center
                `,children:e.jsxs("div",{className:"w-full h-full flex items-center justify-center animate-fade-in relative",children:[e.jsx("div",{className:"relative z-0 w-full h-full flex items-center justify-center",children:e.jsx(z,{})}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-20 pointer-events-auto",children:e.jsx(Y,{})})]})})}),l===v.WON&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-3xl shadow-2xl max-w-sm w-full text-center border-4 border-blue-400 animate-bounce-in",children:[e.jsx("div",{className:"text-6xl mb-4 font-emoji",children:E("üèÜ")}),e.jsx("h2",{className:"text-3xl font-black text-slate-900 dark:text-white mb-2",children:n===c.ONE?"Blue Wins!":"Yellow Wins!"}),e.jsxs("div",{className:"flex flex-col gap-3 mt-6",children:[e.jsx(w,{onClick:i,size:"lg",className:"w-full",children:"Play Again"}),e.jsx(w,{onClick:s,variant:"secondary",className:"w-full",children:"Back to Menu"})]})]})})]})};export{F as LittleLudoGame};
